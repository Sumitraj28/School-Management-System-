{% extends 'dashboard_base.html' %}

{% block title %}Transport Dashboard â€” SMS{% endblock %}

{% block header_title %}Transport Management{% endblock %}
{% block user_role %}Transport Manager{% endblock %}

{% block sidebar_create_btn %}
<a href="/admin/transport/route/add/" class="sidebar-create-btn">
    <span>Add Route</span>
    <span class="btn-plus"><i class="fas fa-plus"></i></span>
</a>
{% endblock %}

{% block sidebar_nav %}
<a href="{% url 'transport:dashboard' %}" class="nav-item active">
    <i class="fas fa-th-large"></i> Dashboard
</a>
<a href="/admin/transport/vehicle/" class="nav-item">
    <i class="fas fa-bus"></i> Vehicles
</a>
<a href="/admin/transport/route/" class="nav-item">
    <i class="fas fa-route"></i> Routes
</a>
<a href="{% url 'transport:log_fuel' %}" class="nav-item">
    <i class="fas fa-gas-pump"></i> Log Fuel
</a>
<a href="{% url 'transport:log_maintenance' %}" class="nav-item">
    <i class="fas fa-wrench"></i> Maintenance
</a>

<div class="nav-label">Admin</div>
<a href="/admin/transport/studenttransport/add/" class="nav-item">
    <i class="fas fa-user-plus"></i> Allocate Route
</a>
<a href="/admin/transport/" class="nav-item">
    <i class="fas fa-cog"></i> Settings
</a>
{% endblock %}



{% block dashboard_content %}

<!-- Welcome Banner -->
<div class="welcome-banner animate-in">
    <div class="welcome-text">
        <h2>Transport Hub ðŸšŒ</h2>
        <p>Monitor your fleet operations, fuel consumption, routes and maintenance â€” all in one place.</p>
    </div>
    <div class="welcome-illustration">
        <svg viewBox="0 0 200 160" fill="none" xmlns="http://www.w3.org/2000/svg">
            <!-- Road -->
            <rect x="10" y="115" width="180" height="12" rx="6" fill="#DDD6FE" />
            <rect x="40" y="119" width="25" height="4" rx="2" fill="#C4B5FD" />
            <rect x="80" y="119" width="25" height="4" rx="2" fill="#C4B5FD" />
            <rect x="120" y="119" width="25" height="4" rx="2" fill="#C4B5FD" />
            <!-- Bus body -->
            <rect x="50" y="65" width="90" height="50" rx="8" fill="#F5C542" />
            <rect x="50" y="65" width="90" height="15" rx="8" fill="#D97706" />
            <!-- Windows -->
            <rect x="58" y="83" width="18" height="14" rx="3" fill="#DBEAFE" />
            <rect x="81" y="83" width="18" height="14" rx="3" fill="#DBEAFE" />
            <rect x="104" y="83" width="18" height="14" rx="3" fill="#DBEAFE" />
            <!-- Door -->
            <rect x="127" y="83" width="10" height="22" rx="2" fill="#FEF3C7" />
            <!-- Wheels -->
            <circle cx="70" cy="118" r="10" fill="#1E1E2D" />
            <circle cx="70" cy="118" r="5" fill="#6B7280" />
            <circle cx="120" cy="118" r="10" fill="#1E1E2D" />
            <circle cx="120" cy="118" r="5" fill="#6B7280" />
            <!-- Headlight -->
            <circle cx="143" cy="95" r="4" fill="#FDE68A" />
            <!-- Exhaust -->
            <circle cx="45" cy="108" r="4" fill="#E5E7EB" opacity="0.5" />
            <circle cx="38" cy="103" r="3" fill="#E5E7EB" opacity="0.3" />
            <!-- Trees -->
            <circle cx="170" cy="90" r="12" fill="#34D399" />
            <rect x="168" y="102" width="4" height="13" fill="#86EFAC" />
            <circle cx="25" cy="95" r="8" fill="#6EE7B7" />
            <rect x="23" y="103" width="4" height="12" fill="#86EFAC" />
        </svg>
    </div>
</div>

<!-- Stats Overview -->
<div class="stats-section animate-in animate-delay-1">
    <div class="stats-section-title">Overview</div>
    <div class="stats-grid">
        <div class="stat-card gradient-yellow">
            <div class="stat-icon yellow"><i class="fas fa-bus"></i></div>
            <div class="stat-info">
                <div class="stat-value">{{ total_vehicles }}</div>
                <div class="stat-label">Vehicles</div>
            </div>
        </div>
        <div class="stat-card gradient-green">
            <div class="stat-icon green"><i class="fas fa-id-card"></i></div>
            <div class="stat-info">
                <div class="stat-value">{{ total_drivers }}</div>
                <div class="stat-label">Drivers</div>
            </div>
        </div>
        <div class="stat-card gradient-purple">
            <div class="stat-icon purple"><i class="fas fa-route"></i></div>
            <div class="stat-info">
                <div class="stat-value">{{ total_routes }}</div>
                <div class="stat-label">Active Routes</div>
            </div>
        </div>
        <div class="stat-card gradient-pink">
            <div class="stat-icon pink"><i class="fas fa-user-graduate"></i></div>
            <div class="stat-info">
                <div class="stat-value">{{ total_transport_students }}</div>
                <div class="stat-label">Students</div>
            </div>
        </div>
    </div>
</div>

<!-- Content Grid -->
<div class="content-grid animate-in animate-delay-2">

    <!-- LEFT: Quick Actions + Fuel Logs -->
    <div style="display: flex; flex-direction: column; gap: 24px;">

        <!-- Quick Actions -->
        <div class="content-card">
            <div class="content-card-header">
                <h3><i class="fas fa-bolt" style="color: var(--accent-yellow); margin-right: 8px;"></i>Quick Actions
                </h3>
            </div>
            <div class="quick-action-grid">
                <a href="{% url 'transport:log_fuel' %}" class="quick-action-item">
                    <div class="qa-icon" style="background: #DBEAFE; color: #2563EB;">
                        <i class="fas fa-gas-pump"></i>
                    </div>
                    <span>Log Fuel</span>
                </a>
                <a href="{% url 'transport:log_maintenance' %}" class="quick-action-item">
                    <div class="qa-icon" style="background: #FEE2E2; color: #DC2626;">
                        <i class="fas fa-wrench"></i>
                    </div>
                    <span>Maintenance</span>
                </a>
                <a href="/admin/transport/studenttransport/add/" class="quick-action-item">
                    <div class="qa-icon" style="background: #D1FAE5; color: #059669;">
                        <i class="fas fa-user-plus"></i>
                    </div>
                    <span>Allocate Route</span>
                </a>
                <a href="/admin/transport/route/" class="quick-action-item">
                    <div class="qa-icon" style="background: #EDE9FE; color: #7C3AED;">
                        <i class="fas fa-map-marked-alt"></i>
                    </div>
                    <span>Manage Routes</span>
                </a>
            </div>
        </div>

        <!-- Fuel Logs Table -->
        <div class="content-card">
            <div class="content-card-header">
                <h3><i class="fas fa-gas-pump" style="color: var(--primary); margin-right: 8px;"></i>Recent Fuel Logs
                </h3>
            </div>
            <div class="content-card-body">
                {% if fuel_logs %}
                {% for log in fuel_logs %}
                <div class="list-item">
                    <div class="list-item-icon" style="background: #DBEAFE; color: #2563EB;">
                        <i class="fas fa-gas-pump"></i>
                    </div>
                    <div class="list-item-content">
                        <h4>{{ log.vehicle }}</h4>
                        <p>{{ log.date }} Â· {{ log.liters }} Liters</p>
                    </div>
                    <div class="list-item-meta">
                        <span class="badge badge-yellow">${{ log.cost }}</span>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="empty-state">
                    <div class="empty-icon"><i class="fas fa-gas-pump"></i></div>
                    <p>No fuel records found.</p>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- RIGHT: Maintenance Alerts -->
    <div style="display: flex; flex-direction: column; gap: 24px;">

        <div class="content-card">
            <div class="content-card-header">
                <h3><i class="fas fa-exclamation-triangle"
                        style="color: var(--accent-pink); margin-right: 8px;"></i>Maintenance Alerts</h3>
            </div>
            <div class="content-card-body">
                {% if maintenance_alerts %}
                {% for alert in maintenance_alerts %}
                <div class="list-item">
                    <div class="list-item-icon" style="background: #FEE2E2; color: #DC2626;">
                        <i class="fas fa-tools"></i>
                    </div>
                    <div class="list-item-content">
                        <h4>{{ alert.vehicle }}</h4>
                        <p>{{ alert.description }}</p>
                    </div>
                    <div class="list-item-meta">
                        <span class="badge badge-pink">${{ alert.cost }}</span>
                    </div>
                </div>
                {% endfor %}
                {% else %}
                <div class="empty-state">
                    <div class="empty-icon"><i class="fas fa-check-circle"></i></div>
                    <p>No recent maintenance logs.</p>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Fleet Info Card -->
        <div class="info-card" style="background: linear-gradient(135deg, #F59E0B, #D97706);">
            <h4><i class="fas fa-bus" style="margin-right: 8px;"></i>Fleet Overview</h4>
            <p>All vehicles and routes are being monitored. Keep your fleet safe and efficient.</p>
            <a href="/admin/transport/vehicle/" class="info-card-btn" style="color: #D97706;">Manage Fleet</a>
        </div>
    </div>
</div>

{% endblock %}