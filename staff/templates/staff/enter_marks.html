{% extends 'dashboard_base.html' %}

{% block title %}Enter Marks — SMS{% endblock %}

{% block header_title %}Enter Marks{% endblock %}
{% block user_role %}Staff{% endblock %}

{% block sidebar_nav %}
<a href="{% url 'staff:dashboard' %}" class="nav-item">
    <i class="fas fa-th-large"></i> Dashboard
</a>
<a href="{% url 'staff:timetable' %}" class="nav-item">
    <i class="fas fa-clock"></i> My Timetable
</a>
<a href="{% url 'staff:select_attendance_class' %}" class="nav-item">
    <i class="fas fa-clipboard-check"></i> Take Attendance
</a>
<a href="{% url 'staff:assign_homework' %}" class="nav-item">
    <i class="fas fa-book-open"></i> Assign Homework
</a>
<a href="{% url 'staff:select_exam' %}" class="nav-item active">
    <i class="fas fa-pen-fancy"></i> Enter Marks
</a>
<div class="nav-label">Personal</div>
<a href="{% url 'staff:apply_leave' %}" class="nav-item">
    <i class="fas fa-calendar-minus"></i> Apply Leave
</a>
<a href="{% url 'staff:view_salary' %}" class="nav-item">
    <i class="fas fa-wallet"></i> Salary Slips
</a>
{% endblock %}

{% block dashboard_content %}
<div class="content-card animate-in">
    <div class="content-card-header">
        <h3><i class="fas fa-edit" style="color: var(--accent-yellow); margin-right: 8px;"></i>Marks: {{ exam.name }} —
            {{ exam.subject.name }}</h3>
    </div>
    <div
        style="padding: 12px 20px; border-bottom: 1px solid var(--border); display: flex; gap: 20px; font-size: 13px; color: var(--text-secondary);">
        <span>Class: <strong style="color: var(--text-primary);">{{ exam.class_group.name }} - {{
                exam.class_group.section }}</strong></span>
        <span>Max Marks: <strong style="color: var(--text-primary);">{{ exam.total_marks }}</strong></span>
    </div>
    <div class="content-card-body">
        <form method="post">
            {% csrf_token %}
            <div style="overflow-x: auto;">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Student Name</th>
                            <th>Marks Obtained</th>
                            <th>Remarks</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for student in students %}
                        <tr>
                            <td style="font-weight: 600;">
                                {{ student.user.first_name }} {{ student.user.last_name }}
                                <span style="color: var(--text-secondary); font-size: 12px;">({{
                                    student.admission_number }})</span>
                            </td>
                            <td>
                                <input type="number" step="0.01" max="{{ exam.total_marks }}"
                                    name="marks_{{ student.id }}"
                                    value="{{ student.current_grade.marks_obtained|default:'' }}" placeholder="0.00"
                                    class="form-input" style="max-width: 120px;">
                            </td>
                            <td>
                                <input type="text" name="remarks_{{ student.id }}" placeholder="Good/Poor/Excellent"
                                    value="{{ student.current_grade.remarks|default:'' }}" class="form-input">
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            <div style="display: flex; justify-content: flex-end; margin-top: 20px;">
                <button type="submit" class="sidebar-create-btn"
                    style="display: inline-flex; gap: 8px; background: linear-gradient(135deg, #059669, #34D399);">
                    <i class="fas fa-save"></i> Save Marks
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}